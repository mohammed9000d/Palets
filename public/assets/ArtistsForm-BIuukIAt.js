import{a0 as ae,a5 as ie,a6 as re,u as ne,r as x,j as e,M as oe,B as r,a1 as U,q as f,a8 as le,I as z,T as m,G as l,F as ce,a9 as de,N as me,aa as ue}from"./index-B1lwnqt0.js";import{b as R}from"./api-pH0XAhJ5.js";import{I as xe}from"./IconArrowLeft-BN7lpi_5.js";import{A as $}from"./Alert-u0NGmxlB.js";import{I as he,a as pe,b as G}from"./IconX-CgeALw5F.js";import{T as g}from"./TextField-DXmCMhOG.js";import{I as b}from"./InputAdornment-VXwk7dN8.js";import{I as N,a as q,b as ge,c as je,d as be,e as fe,f as ye,g as ve,h as _e}from"./IconWorld-lDu1SJi0.js";import{S as ke}from"./Switch-B13JdSNE.js";import{I as Ie}from"./IconCurrencyDollar-BYCU2oPE.js";import{B as S}from"./Button-Df8HaDE5.js";import{I as Ce}from"./IconTrash-CUzANWxc.js";import"./InputLabel-D3rw_fEJ.js";const Oe=()=>{const P=ae(),{slug:y}=ie();re();const u=!!y,i=ne(),[H,T]=x.useState(!1),[F,L]=x.useState(!1),[M,v]=x.useState(""),[O,D]=x.useState(""),[c,I]=x.useState({artist_name:"",bio:"",link:"",is_active:!0,social_links:{instagram:"",twitter:"",facebook:"",linkedin:"",youtube:"",website:""},contact_email:"",phone:"",specialties:"",commission_rate:""}),[K,C]=x.useState({avatar:null,gallery_images:[]}),[w,A]=x.useState({avatar:null,gallery_images:[]}),[_,W]=x.useState({avatar:null,gallery:[]});x.useEffect(()=>{u&&y&&X()},[u,y]);const X=async()=>{var t,s,n,a,d,k;T(!0);try{const o=(await R.getBySlug(y)).data.artist;I({artist_name:o.artist_name||"",bio:o.bio||"",link:o.link||"",is_active:o.is_active,social_links:{instagram:((t=o.social_links)==null?void 0:t.instagram)||"",twitter:((s=o.social_links)==null?void 0:s.twitter)||"",facebook:((n=o.social_links)==null?void 0:n.facebook)||"",linkedin:((a=o.social_links)==null?void 0:a.linkedin)||"",youtube:((d=o.social_links)==null?void 0:d.youtube)||"",website:((k=o.social_links)==null?void 0:k.website)||""},contact_email:o.contact_email||"",phone:o.phone||"",specialties:o.specialties||"",commission_rate:o.commission_rate||""}),o.avatar_url&&W(B=>({...B,avatar:o.avatar_url})),o.gallery_images&&o.gallery_images.length>0&&W(B=>({...B,gallery:o.gallery_images.map(E=>({id:E.id,url:E.url,thumb:E.thumb}))}))}catch(j){v("Failed to load artist data"),console.error("Error loading artist:",j)}finally{T(!1)}},h=t=>{const{name:s,value:n}=t.target;if(s.startsWith("social_")){const a=s.replace("social_","");I(d=>({...d,social_links:{...d.social_links,[a]:n}}))}else I(a=>({...a,[s]:n}))},Y=t=>{I(s=>({...s,is_active:t.target.checked}))},J=t=>{const s=t.target.files[0];if(s){C(a=>({...a,avatar:s}));const n=new FileReader;n.onloadend=()=>{A(a=>({...a,avatar:n.result}))},n.readAsDataURL(s)}},Q=t=>{const s=Array.from(t.target.files);C(n=>({...n,gallery_images:[...n.gallery_images,...s]})),s.forEach(n=>{const a=new FileReader;a.onloadend=()=>{A(d=>({...d,gallery_images:[...d.gallery_images,a.result]}))},a.readAsDataURL(n)})},V=()=>{C(t=>({...t,avatar:null})),A(t=>({...t,avatar:null})),u&&W(t=>({...t,avatar:null}))},Z=t=>{C(s=>({...s,gallery_images:s.gallery_images.filter((n,a)=>a!==t)})),A(s=>({...s,gallery_images:s.gallery_images.filter((n,a)=>a!==t)}))},ee=t=>{W(s=>({...s,gallery:s.gallery.filter((n,a)=>a!==t)}))},te=async t=>{var s,n;t.preventDefault(),L(!0),v(""),D("");try{const a={};Object.keys(c.social_links).forEach(j=>{c.social_links[j]&&c.social_links[j].trim()!==""&&(a[j]=c.social_links[j].trim())});const d={...c,social_links:a,...K};u&&(_.avatar||(d.remove_avatar=!0));let k;u?k=await R.update(y,d):k=await R.create(d),D(`Artist ${u?"updated":"created"} successfully!`),setTimeout(()=>{P("/admin/artists")},1500)}catch(a){if((n=(s=a.response)==null?void 0:s.data)!=null&&n.errors){const d=Object.values(a.response.data.errors).flat();v(d.join(", "))}else v(`Failed to ${u?"update":"create"} artist`);console.error("Error submitting form:",a)}finally{L(!1)}};if(H)return e.jsx(oe,{children:e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(U,{})})});const p={"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:i.palette.mode==="dark"?f(i.palette.background.paper,.8):"#fff","&:hover":{"& .MuiOutlinedInput-notchedOutline":{borderColor:i.palette.primary.main}},"&.Mui-focused":{"& .MuiOutlinedInput-notchedOutline":{borderWidth:1.5}}},"& .MuiOutlinedInput-notchedOutline":{borderColor:i.palette.mode==="dark"?f(i.palette.divider,.2):f(i.palette.divider,.3)},"& .MuiInputLabel-root":{color:i.palette.text.secondary,fontWeight:400}},se={instagram:e.jsx(_e,{size:20}),twitter:e.jsx(ve,{size:20}),facebook:e.jsx(ye,{size:20}),linkedin:e.jsx(fe,{size:20}),youtube:e.jsx(be,{size:20}),website:e.jsx(q,{size:20})};return e.jsx(le,{in:!0,children:e.jsxs(r,{children:[e.jsxs(r,{mb:4,children:[e.jsxs(r,{display:"flex",alignItems:"center",gap:2,mb:1,children:[e.jsx(z,{onClick:()=>P("/admin/artists"),size:"small",children:e.jsx(xe,{})}),e.jsx(m,{variant:"h2",fontWeight:600,children:u?"Edit Artist":"Create New Artist"})]}),e.jsx(m,{variant:"body2",color:"text.secondary",children:u?"Update artist information and media":"Add a new artist to your gallery"})]}),M&&e.jsx($,{severity:"error",onClose:()=>v(""),sx:{mb:3},children:M}),O&&e.jsx($,{severity:"success",icon:e.jsx(he,{}),sx:{mb:3},children:O}),e.jsxs("form",{onSubmit:te,children:[e.jsxs(l,{container:!0,spacing:4,children:[e.jsx(l,{item:!0,xs:12,md:8,children:e.jsxs(r,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(r,{children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Basic Information"}),e.jsxs(l,{container:!0,spacing:2.5,children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Artist Name",name:"artist_name",value:c.artist_name,onChange:h,required:!0,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(N,{size:20,style:{color:i.palette.text.secondary}})})}})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(g,{fullWidth:!0,label:"Biography",name:"bio",value:c.bio,onChange:h,multiline:!0,rows:4,sx:p,placeholder:"Tell us about the artist..."})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Portfolio/Website URL",name:"link",value:c.link,onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(q,{size:20,style:{color:i.palette.text.secondary}})})},placeholder:"https://artist-portfolio.com"})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(ce,{control:e.jsx(ke,{checked:c.is_active,onChange:Y,color:"primary"}),label:e.jsxs(r,{children:[e.jsx(m,{variant:"body1",children:"Active Artist"}),e.jsx(m,{variant:"caption",color:"text.secondary",children:"Artist profile is visible to public"})]}),sx:{m:0,"& .MuiFormControlLabel-label":{ml:1}}})})]})]}),e.jsxs(r,{children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Contact Information"}),e.jsxs(l,{container:!0,spacing:2.5,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Contact Email",name:"contact_email",type:"email",value:c.contact_email,onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(ge,{size:20,style:{color:i.palette.text.secondary}})})}})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(g,{fullWidth:!0,label:"Phone Number",name:"phone",value:c.phone,onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(je,{size:20,style:{color:i.palette.text.secondary}})})}})})]})]}),e.jsxs(r,{children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Professional Details"}),e.jsxs(l,{container:!0,spacing:2.5,children:[e.jsx(l,{item:!0,xs:12,md:8,children:e.jsx(g,{fullWidth:!0,label:"Art Specialties",name:"specialties",value:c.specialties,onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(de,{size:20,style:{color:i.palette.text.secondary}})})},placeholder:"Oil painting, Watercolor, Digital art..."})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsx(g,{fullWidth:!0,label:"Commission Rate (%)",name:"commission_rate",type:"number",value:c.commission_rate,onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:e.jsx(Ie,{size:20,style:{color:i.palette.text.secondary}})}),inputProps:{min:0,max:99.99,step:.01}}})})]})]}),e.jsxs(r,{children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Social Media & Online Presence"}),e.jsx(l,{container:!0,spacing:2.5,children:Object.keys(c.social_links).map(t=>e.jsx(l,{item:!0,xs:12,sm:6,md:4,children:e.jsx(g,{fullWidth:!0,label:t.charAt(0).toUpperCase()+t.slice(1),name:`social_${t}`,value:c.social_links[t],onChange:h,sx:p,InputProps:{startAdornment:e.jsx(b,{position:"start",children:se[t]})},placeholder:t==="website"?"https://...":"@username"})},t))})]})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(r,{sx:{position:"sticky",top:24},children:[e.jsxs(r,{mb:4,children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Profile Photo"}),e.jsxs(r,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[e.jsx(me,{src:w.avatar||_.avatar,sx:{width:160,height:160,border:`2px solid ${i.palette.divider}`,backgroundColor:i.palette.background.default},children:e.jsx(N,{size:60,style:{color:i.palette.text.disabled}})}),e.jsxs(r,{display:"flex",gap:1,children:[e.jsxs(S,{variant:"outlined",component:"label",startIcon:e.jsx(pe,{size:18}),size:"small",sx:{borderRadius:2,textTransform:"none",fontWeight:400},children:["Upload Photo",e.jsx("input",{type:"file",hidden:!0,accept:"image/*",onChange:J})]}),(w.avatar||_.avatar)&&e.jsx(z,{onClick:V,size:"small",sx:{color:"error.main",border:"1px solid",borderColor:"error.main","&:hover":{backgroundColor:f(i.palette.error.main,.08)}},children:e.jsx(Ce,{size:18})})]})]})]}),e.jsxs(r,{children:[e.jsx(m,{variant:"h5",fontWeight:500,mb:2.5,children:"Gallery Images"}),e.jsxs(S,{variant:"outlined",component:"label",fullWidth:!0,startIcon:e.jsx(ue,{size:18}),sx:{mb:2,py:1.5,borderRadius:2,borderStyle:"dashed",textTransform:"none",fontWeight:400},children:["Add Gallery Images",e.jsx("input",{type:"file",hidden:!0,multiple:!0,accept:"image/*",onChange:Q})]}),_.gallery.length>0&&e.jsxs(r,{mb:2,children:[e.jsx(m,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:"Existing images"}),e.jsx(r,{display:"flex",flexWrap:"wrap",gap:1,children:_.gallery.map((t,s)=>e.jsxs(r,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:`1px solid ${i.palette.divider}`},children:[e.jsx("img",{src:t.thumb||t.url||t,alt:`Gallery ${s+1}`,style:{width:80,height:80,objectFit:"cover"}}),e.jsx(z,{size:"small",onClick:()=>ee(s),sx:{position:"absolute",top:2,right:2,backgroundColor:f(i.palette.background.paper,.9),"&:hover":{backgroundColor:i.palette.background.paper}},children:e.jsx(G,{size:16})})]},s))})]}),w.gallery_images.length>0&&e.jsxs(r,{children:[e.jsx(m,{variant:"caption",color:"text.secondary",sx:{mb:1,display:"block"},children:"New images to upload"}),e.jsx(r,{display:"flex",flexWrap:"wrap",gap:1,children:w.gallery_images.map((t,s)=>e.jsxs(r,{sx:{position:"relative",borderRadius:1.5,overflow:"hidden",border:`1px solid ${i.palette.primary.main}`},children:[e.jsx("img",{src:t,alt:`New ${s+1}`,style:{width:80,height:80,objectFit:"cover"}}),e.jsx(z,{size:"small",onClick:()=>Z(s),sx:{position:"absolute",top:2,right:2,backgroundColor:f(i.palette.background.paper,.9),"&:hover":{backgroundColor:i.palette.background.paper}},children:e.jsx(G,{size:16})})]},s))})]})]})]})})]}),e.jsxs(r,{sx:{mt:5,pt:3,borderTop:`1px solid ${i.palette.divider}`,display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(S,{variant:"outlined",onClick:()=>P("/admin/artists"),disabled:F,sx:{borderRadius:2,px:3,textTransform:"none",fontWeight:400},children:"Cancel"}),e.jsx(S,{type:"submit",variant:"contained",disabled:F,sx:{borderRadius:2,px:4,textTransform:"none",fontWeight:500,boxShadow:"none","&:hover":{boxShadow:"none"}},children:F?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:20,sx:{mr:1}}),u?"Updating...":"Creating..."]}):e.jsx(e.Fragment,{children:u?"Update Artist":"Create Artist"})})]})]})]})})};export{Oe as default};
