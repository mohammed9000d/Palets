import{a0 as I,a5 as D,a6 as L,r as o,j as e,M,B as v,F as P,a1 as k}from"./index-DJ-mX6Fk.js";import{a as j}from"./api-T5aaLTAo.js";import{A as w}from"./Alert-DLo_mUvi.js";import{T as b,S as T}from"./TextField-BUP45Fpy.js";import{F as W,I as q}from"./InputLabel-C7p_2NM4.js";import{M as S}from"./MenuItem-nZqInD8j.js";import{S as R}from"./Switch-Dja_XEYG.js";import{B as A}from"./Button-Bm3vhWTS.js";const K=()=>{const g=I(),{id:d}=D(),p=L(),i=!!d,[n,f]=o.useState({name:"",email:"",password:"",role:"admin",is_active:!0}),[t,c]=o.useState(!1),[y,m]=o.useState(""),[C,h]=o.useState("");o.useEffect(()=>{var r;if(i)if((r=p.state)!=null&&r.admin){const a=p.state.admin;f({name:a.name,email:a.email,password:"",role:a.role,is_active:a.is_active})}else E()},[d,i,p.state]);const E=async()=>{try{c(!0);const a=(await j.getById(d)).data;f({name:a.name,email:a.email,password:"",role:a.role,is_active:a.is_active})}catch(r){m("Failed to fetch admin details"),console.error("Error fetching admin:",r)}finally{c(!1)}},l=r=>{const{name:a,value:u,checked:s}=r.target;f(x=>({...x,[a]:a==="is_active"?s:u}))},F=async r=>{var a,u;r.preventDefault(),c(!0),m(""),h("");try{const s={...n};i&&!s.password&&delete s.password,i?(await j.update(d,s),h("Admin updated successfully!")):(await j.create(s),h("Admin created successfully!")),setTimeout(()=>{g("/admin/list")},2e3)}catch(s){if((u=(a=s.response)==null?void 0:a.data)!=null&&u.errors){const x=s.response.data.errors,B=Object.values(x).flat().join(", ");m(B)}else m("Failed to save admin. Please try again.");console.error("Error saving admin:",s)}finally{c(!1)}},_=()=>{g("/admin/list")};return e.jsxs(M,{title:i?"Edit Admin":"Create Admin",children:[y&&e.jsx(w,{severity:"error",sx:{mb:2},children:y}),C&&e.jsx(w,{severity:"success",sx:{mb:2},children:C}),e.jsx(v,{component:"form",onSubmit:F,noValidate:!0,children:e.jsxs(v,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(b,{fullWidth:!0,label:"Name",name:"name",value:n.name,onChange:l,required:!0,disabled:t}),e.jsx(b,{fullWidth:!0,label:"Email",name:"email",type:"email",value:n.email,onChange:l,required:!0,disabled:t}),e.jsx(b,{fullWidth:!0,label:"Password",name:"password",type:"password",value:n.password,onChange:l,required:!i,helperText:i?"Leave empty to keep current password":"",disabled:t}),e.jsxs(W,{fullWidth:!0,children:[e.jsx(q,{children:"Role"}),e.jsxs(T,{name:"role",value:n.role,onChange:l,label:"Role",disabled:t,children:[e.jsx(S,{value:"admin",children:"Admin"}),e.jsx(S,{value:"super_admin",children:"Super Admin"})]})]}),e.jsx(P,{control:e.jsx(R,{name:"is_active",checked:n.is_active,onChange:l,disabled:t}),label:"Active"}),e.jsxs(v,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(A,{variant:"outlined",onClick:_,disabled:t,children:"Cancel"}),e.jsx(A,{type:"submit",variant:"contained",disabled:t,startIcon:t?e.jsx(k,{size:20}):null,children:t?"Saving...":i?"Update":"Create"})]})]})})]})};export{K as default};
