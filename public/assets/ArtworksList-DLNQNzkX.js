import{a0 as Z,r as l,j as e,M as E,B as u,a1 as ee,G as x,a2 as te,ab as z,T as a,N,a3 as B,I as f,a4 as re}from"./index-ByOtDWtE.js";import{b as se,c as b}from"./api-pH0XAhJ5.js";import{A as ae}from"./Alert-BZtpLnbm.js";import{T as le,S}from"./TextField-3-DLEGSP.js";import{I as ne}from"./InputAdornment-B9yLzoYc.js";import{I as ie,a as oe}from"./IconSearch-Cw3g9U6P.js";import{F as C,I}from"./InputLabel-26HtUWP1.js";import{M as n}from"./MenuItem-CKpLT3cH.js";import{T as ce,a as de,b as he,c as w,d as r,e as ue,I as xe,D as je,f as ge,g as pe,h as me}from"./TableRow-W6h__gOf.js";import{I as fe}from"./IconCurrencyDollar-kOR_qD3P.js";import{I as ve}from"./IconStar-5DWTiyi_.js";import{I as ye}from"./IconTrash-Bv7o_oSw.js";import{B as j}from"./Button-CkrTntBS.js";const ze=()=>{var P;const v=Z(),[y,M]=l.useState([]),[W,L]=l.useState([]),[R,F]=l.useState(!0),[T,g]=l.useState(""),[_,A]=l.useState({open:!1,artwork:null}),[p,V]=l.useState(""),[o,$]=l.useState("all"),[c,G]=l.useState("all"),[d,H]=l.useState("all"),[s,U]=l.useState({current_page:1,per_page:12,total:0,last_page:1});l.useEffect(()=>{q(),m()},[p,o,c,d]);const q=async()=>{try{const t=await se.getAll();L(t.data.data||[])}catch(t){console.error("Error fetching artists:",t)}},m=async(t=1)=>{try{F(!0);const i={page:t,per_page:s.per_page,search:p||void 0,status:o!=="all"?o:void 0,artist_id:c!=="all"?c:void 0,featured:d==="featured"?!0:d==="not_featured"?!1:void 0},h=await b.getAll(i);M(h.data.data),U({current_page:h.data.current_page,per_page:h.data.per_page,total:h.data.total,last_page:h.data.last_page}),g("")}catch(i){g("Failed to fetch artworks. Please check if the backend server is running."),console.error("Error fetching artworks:",i)}finally{F(!1)}},J=async t=>{try{await b.delete(t.slug),m(s.current_page),A({open:!1,artwork:null})}catch(i){g("Failed to delete artwork"),console.error("Error deleting artwork:",i)}},K=t=>{v(`/admin/artworks/edit/${t.slug}`,{state:{artwork:t}})},O=t=>{v(`/admin/artworks/view/${t.slug}`,{state:{artwork:t}})},Q=async t=>{try{await b.toggleFeatured(t.slug),m(s.current_page)}catch(i){g("Failed to toggle featured status"),console.error("Error toggling featured:",i)}},X=t=>{A({open:!0,artwork:t})},D=()=>{A({open:!1,artwork:null})},k=t=>{m(t)},Y=t=>{switch(t){case"published":return"success";case"draft":return"warning";case"archived":return"default";default:return"default"}};return R&&y.length===0?e.jsx(E,{title:"Artworks Management",children:e.jsx(u,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(ee,{})})}):e.jsxs(E,{title:"Artworks Management",secondary:e.jsx(j,{variant:"contained",startIcon:e.jsx(re,{}),onClick:()=>v("/admin/artworks/create"),children:"Add New Artwork"}),children:[T&&e.jsx(ae,{severity:"error",sx:{mb:2},children:T}),e.jsxs(x,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(x,{item:!0,xs:12,sm:6,md:3,children:e.jsx(le,{fullWidth:!0,placeholder:"Search artworks...",value:p,onChange:t=>V(t.target.value),InputProps:{startAdornment:e.jsx(ne,{position:"start",children:e.jsx(ie,{size:20})})}})}),e.jsx(x,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(I,{children:"Status"}),e.jsxs(S,{value:o,onChange:t=>$(t.target.value),label:"Status",children:[e.jsx(n,{value:"all",children:"All Status"}),e.jsx(n,{value:"published",children:"Published"}),e.jsx(n,{value:"draft",children:"Draft"}),e.jsx(n,{value:"archived",children:"Archived"})]})]})}),e.jsx(x,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(I,{children:"Artist"}),e.jsxs(S,{value:c,onChange:t=>G(t.target.value),label:"Artist",children:[e.jsx(n,{value:"all",children:"All Artists"}),W.map(t=>e.jsx(n,{value:t.id,children:t.artist_name},t.id))]})]})}),e.jsx(x,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(C,{fullWidth:!0,children:[e.jsx(I,{children:"Featured"}),e.jsxs(S,{value:d,onChange:t=>H(t.target.value),label:"Featured",children:[e.jsx(n,{value:"all",children:"All"}),e.jsx(n,{value:"featured",children:"Featured"}),e.jsx(n,{value:"not_featured",children:"Not Featured"})]})]})})]}),e.jsx(ce,{component:te,children:e.jsxs(de,{children:[e.jsx(he,{children:e.jsxs(w,{children:[e.jsx(r,{children:"Cover"}),e.jsx(r,{children:"Title"}),e.jsx(r,{children:"Artist"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Price"}),e.jsx(r,{children:"Featured"}),e.jsx(r,{children:"Views"}),e.jsx(r,{align:"center",children:"Actions"})]})}),e.jsx(ue,{children:y.length===0?e.jsx(w,{children:e.jsx(r,{colSpan:8,align:"center",children:e.jsxs(u,{py:3,children:[e.jsx(z,{size:48,stroke:1.5,style:{color:"#ccc"}}),e.jsx(a,{variant:"h6",color:"textSecondary",sx:{mt:2},children:"No artworks found"}),e.jsx(a,{variant:"body2",color:"textSecondary",children:p||o!=="all"||c!=="all"||d!=="all"?"Try adjusting your filters":"Start by adding your first artwork"})]})})}):y.map(t=>e.jsxs(w,{hover:!0,children:[e.jsx(r,{children:e.jsx(N,{src:t.cover_image_thumb_url,alt:t.title,sx:{width:50,height:50},variant:"rounded",children:e.jsx(z,{})})}),e.jsxs(r,{children:[e.jsx(a,{variant:"subtitle1",fontWeight:"medium",children:t.title}),t.overview&&e.jsx(a,{variant:"body2",color:"textSecondary",sx:{maxWidth:200},children:t.overview.length>50?`${t.overview.substring(0,50)}...`:t.overview})]}),e.jsx(r,{children:t.artist?e.jsxs(u,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(N,{src:t.artist.avatar_thumb_url,sx:{width:24,height:24},children:t.artist.artist_name.charAt(0)}),e.jsx(a,{variant:"body2",children:t.artist.artist_name})]}):e.jsx(a,{variant:"body2",color:"textSecondary",children:"Unknown Artist"})}),e.jsx(r,{children:e.jsx(B,{label:t.status.charAt(0).toUpperCase()+t.status.slice(1),color:Y(t.status),size:"small"})}),e.jsxs(r,{children:[t.price?e.jsxs(u,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(fe,{size:16}),e.jsx(a,{variant:"body2",children:parseFloat(t.price).toLocaleString()})]}):e.jsx(a,{variant:"body2",color:"textSecondary",children:"Not priced"}),t.is_for_sale&&e.jsx(B,{label:"For Sale",color:"info",size:"small",sx:{mt:.5}})]}),e.jsx(r,{children:e.jsx(f,{size:"small",onClick:()=>Q(t),color:t.is_featured?"warning":"default",title:t.is_featured?"Remove from featured":"Add to featured",children:e.jsx(ve,{fill:t.is_featured?"currentColor":"none"})})}),e.jsxs(r,{children:[e.jsx(a,{variant:"body2",children:t.view_count||0}),e.jsxs(a,{variant:"caption",color:"textSecondary",children:[t.like_count||0," likes"]})]}),e.jsxs(r,{align:"center",children:[e.jsx(f,{size:"small",onClick:()=>O(t),title:"View Artwork",children:e.jsx(oe,{})}),e.jsx(f,{size:"small",onClick:()=>K(t),title:"Edit Artwork",children:e.jsx(xe,{})}),e.jsx(f,{size:"small",onClick:()=>X(t),title:"Delete Artwork",color:"error",children:e.jsx(ye,{})})]})]},t.id))})]})}),s.last_page>1&&e.jsxs(u,{display:"flex",justifyContent:"center",mt:3,children:[e.jsx(j,{disabled:s.current_page===1,onClick:()=>k(s.current_page-1),sx:{mr:1},children:"Previous"}),e.jsxs(a,{variant:"body2",sx:{mx:2,alignSelf:"center"},children:["Page ",s.current_page," of ",s.last_page,"(",s.total," total artworks)"]}),e.jsx(j,{disabled:s.current_page===s.last_page,onClick:()=>k(s.current_page+1),sx:{ml:1},children:"Next"})]}),e.jsxs(je,{open:_.open,onClose:D,children:[e.jsx(ge,{children:"Delete Artwork"}),e.jsx(pe,{children:e.jsxs(a,{children:['Are you sure you want to delete "',(P=_.artwork)==null?void 0:P.title,'"? This action cannot be undone.']})}),e.jsxs(me,{children:[e.jsx(j,{onClick:D,children:"Cancel"}),e.jsx(j,{onClick:()=>J(_.artwork),color:"error",variant:"contained",children:"Delete"})]})]})]})};export{ze as default};
