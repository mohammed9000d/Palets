import{a0 as E,r as t,j as e,M as y,B as a,a1 as S,a2 as B,T as r,N as C,I as x,a4 as M}from"./index-DNfr9x4F.js";import{n as b}from"./api-BQFhURCH.js";import{g as I}from"./imageHelper-D6Ik51Rl.js";import{A as P}from"./Alert-76NRBqFV.js";import{T as R,a as z,b as F,c as j,d as s,e as L,D as H,f as $,g as U,h as V}from"./TableRow-6aba_KU0.js";import{C as W}from"./CardMedia-DyAc64lZ.js";import{I as q}from"./IconEye-ClaN6I9X.js";import{I as G}from"./IconEdit-CE5Qx0NF.js";import{I as J}from"./IconTrash-D5OUtA2T.js";import{B as g}from"./Button-CLm7eKfg.js";const te=()=>{var w;const o=E(),[i,u]=t.useState([]),[D,p]=t.useState(!0),[f,l]=t.useState(""),[c,d]=t.useState({open:!1,newsItem:null});t.useEffect(()=>{v()},[]);const v=async()=>{try{p(!0);const n=await b.getAll();u(n.data.data||[]),l("")}catch(n){l("Failed to fetch news. Please check if the backend server is running."),console.error("Error fetching news:",n)}finally{p(!1)}},T=async n=>{try{await b.delete(n.id),u(i.filter(h=>h.id!==n.id)),d({open:!1,newsItem:null})}catch(h){l("Failed to delete news"),console.error("Error deleting news:",h)}},A=n=>{o(`/admin/news/${n.id}/edit`)},_=n=>{o(`/admin/news/${n.id}`)},N=n=>{d({open:!0,newsItem:n})},m=()=>{d({open:!1,newsItem:null})},k=n=>new Date(n).toLocaleDateString();return D?e.jsx(y,{title:"News Management",children:e.jsx(a,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(S,{})})}):e.jsxs(y,{title:"News Management",secondary:e.jsx(g,{variant:"contained",startIcon:e.jsx(M,{}),onClick:()=>o("/admin/news/create"),children:"Add News"}),children:[f&&e.jsx(P,{severity:"error",sx:{mb:2},children:f}),e.jsx(R,{component:B,children:e.jsxs(z,{children:[e.jsx(F,{children:e.jsxs(j,{children:[e.jsx(s,{children:"ID"}),e.jsx(s,{children:"Cover"}),e.jsx(s,{children:"Title"}),e.jsx(s,{children:"Author"}),e.jsx(s,{children:"Created At"}),e.jsx(s,{align:"center",children:"Actions"})]})}),e.jsx(L,{children:i.length===0?e.jsx(j,{children:e.jsx(s,{colSpan:6,align:"center",children:e.jsx(r,{variant:"body2",color:"textSecondary",children:"No news articles found. Create your first news article!"})})}):i.map(n=>e.jsxs(j,{children:[e.jsx(s,{children:n.id}),e.jsx(s,{children:n.cover_photo?e.jsx(W,{component:"img",sx:{width:60,height:60,borderRadius:1,objectFit:"cover"},image:I(n.cover_photo),alt:n.main_title}):e.jsx(a,{sx:{width:60,height:60,backgroundColor:"#f5f5f5",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(r,{variant:"caption",color:"textSecondary",children:"No Image"})})}),e.jsx(s,{children:e.jsxs(a,{children:[e.jsx(r,{variant:"subtitle2",fontWeight:"bold",children:n.main_title}),n.sub_title&&e.jsx(r,{variant:"body2",color:"textSecondary",children:n.sub_title})]})}),e.jsx(s,{children:e.jsxs(a,{display:"flex",alignItems:"center",gap:1,children:[n.author_photo?e.jsx(C,{src:I(n.author_photo),sx:{width:32,height:32}}):e.jsx(C,{sx:{width:32,height:32},children:n.author_name.charAt(0)}),e.jsx(r,{variant:"body2",children:n.author_name})]})}),e.jsx(s,{children:k(n.created_at)}),e.jsxs(s,{align:"center",children:[e.jsx(x,{color:"info",onClick:()=>_(n),size:"small",children:e.jsx(q,{})}),e.jsx(x,{color:"primary",onClick:()=>A(n),size:"small",children:e.jsx(G,{})}),e.jsx(x,{color:"error",onClick:()=>N(n),size:"small",children:e.jsx(J,{})})]})]},n.id))})]})}),e.jsxs(H,{open:c.open,onClose:m,children:[e.jsx($,{children:"Confirm Delete"}),e.jsx(U,{children:e.jsxs(r,{children:['Are you sure you want to delete news article "',(w=c.newsItem)==null?void 0:w.main_title,'"? This action cannot be undone.']})}),e.jsxs(V,{children:[e.jsx(g,{onClick:m,children:"Cancel"}),e.jsx(g,{onClick:()=>T(c.newsItem),color:"error",variant:"contained",children:"Delete"})]})]})]})};export{te as default};
