import{a0 as k,a5 as M,a6 as T,r as c,j as e,M as U,B as F,G as s,T as x,D as b,F as v,a1 as A}from"./index-DJ-mX6Fk.js";import{u as C}from"./api-T5aaLTAo.js";import{A as P}from"./Alert-DLo_mUvi.js";import{T as n,S as N}from"./TextField-BUP45Fpy.js";import{F as G,I as q}from"./InputLabel-C7p_2NM4.js";import{M as f}from"./MenuItem-nZqInD8j.js";import{S as w}from"./Switch-Dja_XEYG.js";import{B as I}from"./Button-Bm3vhWTS.js";const Y=()=>{const S=k(),{id:u}=M(),g=T(),d=!!u,[r,p]=c.useState({name:"",email:"",password:"",phone:"",country_code:"",first_name:"",last_name:"",date_of_birth:"",gender:"",street_address:"",city:"",state:"",postal_code:"",country:"",billing_street_address:"",billing_city:"",billing_state:"",billing_postal_code:"",billing_country:"",newsletter_subscription:!1,sms_notifications:!1,is_active:!0,preferred_language:"",timezone:""}),[a,m]=c.useState(!1),[W,_]=c.useState(""),[B,j]=c.useState("");c.useEffect(()=>{var o;if(d)if((o=g.state)!=null&&o.user){const t=g.state.user;p({name:t.name||"",email:t.email||"",password:"",phone:t.phone||"",country_code:t.country_code||"",first_name:t.first_name||"",last_name:t.last_name||"",date_of_birth:t.date_of_birth||"",gender:t.gender||"",street_address:t.street_address||"",city:t.city||"",state:t.state||"",postal_code:t.postal_code||"",country:t.country||"",billing_street_address:t.billing_street_address||"",billing_city:t.billing_city||"",billing_state:t.billing_state||"",billing_postal_code:t.billing_postal_code||"",billing_country:t.billing_country||"",newsletter_subscription:t.newsletter_subscription||!1,sms_notifications:t.sms_notifications||!1,is_active:t.is_active!==void 0?t.is_active:!0,preferred_language:t.preferred_language||"",timezone:t.timezone||""})}else z()},[u,d,g.state]);const z=async()=>{try{m(!0);const t=(await C.getById(u)).data;p({name:t.name||"",email:t.email||"",password:"",phone:t.phone||"",country_code:t.country_code||"",first_name:t.first_name||"",last_name:t.last_name||"",date_of_birth:t.date_of_birth||"",gender:t.gender||"",street_address:t.street_address||"",city:t.city||"",state:t.state||"",postal_code:t.postal_code||"",country:t.country||"",billing_street_address:t.billing_street_address||"",billing_city:t.billing_city||"",billing_state:t.billing_state||"",billing_postal_code:t.billing_postal_code||"",billing_country:t.billing_country||"",newsletter_subscription:t.newsletter_subscription||!1,sms_notifications:t.sms_notifications||!1,is_active:t.is_active!==void 0?t.is_active:!0,preferred_language:t.preferred_language||"",timezone:t.timezone||""})}catch(o){_("Failed to fetch user details"),console.error("Error fetching user:",o)}finally{m(!1)}},i=o=>{const{name:t,value:h,checked:l}=o.target;p(y=>({...y,[t]:t==="is_active"||t==="newsletter_subscription"||t==="sms_notifications"?l:h}))},E=async o=>{var t,h;o.preventDefault(),m(!0),_(""),j("");try{const l={...r};d&&!l.password&&delete l.password,d?(await C.update(u,l),j("User updated successfully!")):(await C.create(l),j("User created successfully!")),setTimeout(()=>{S("/admin/users")},2e3)}catch(l){if((h=(t=l.response)==null?void 0:t.data)!=null&&h.errors){const y=l.response.data.errors,L=Object.values(y).flat().join(", ");_(L)}else _("Failed to save user. Please try again.");console.error("Error saving user:",l)}finally{m(!1)}},D=()=>{S("/admin/users")};return e.jsxs(U,{title:d?"Edit User":"Create User",children:[W&&e.jsx(P,{severity:"error",sx:{mb:2},children:W}),B&&e.jsx(P,{severity:"success",sx:{mb:2},children:B}),e.jsx(F,{component:"form",onSubmit:E,noValidate:!0,children:e.jsxs(s,{container:!0,spacing:3,children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsx(x,{variant:"h6",gutterBottom:!0,children:"Basic Information"}),e.jsx(b,{sx:{mb:2}})]}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Display Name",name:"name",value:r.name,onChange:i,required:!0,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Email",name:"email",type:"email",value:r.email,onChange:i,required:!0,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Password",name:"password",type:"password",value:r.password,onChange:i,required:!d,helperText:d?"Leave empty to keep current password":"",disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Phone",name:"phone",value:r.phone,onChange:i,disabled:a})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(x,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Personal Information"}),e.jsx(b,{sx:{mb:2}})]}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"First Name",name:"first_name",value:r.first_name,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Last Name",name:"last_name",value:r.last_name,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Date of Birth",name:"date_of_birth",type:"date",value:r.date_of_birth,onChange:i,InputLabelProps:{shrink:!0},disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsxs(G,{fullWidth:!0,children:[e.jsx(q,{children:"Gender"}),e.jsxs(N,{name:"gender",value:r.gender,onChange:i,label:"Gender",disabled:a,children:[e.jsx(f,{value:"",children:"Select Gender"}),e.jsx(f,{value:"male",children:"Male"}),e.jsx(f,{value:"female",children:"Female"}),e.jsx(f,{value:"other",children:"Other"})]})]})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(x,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Address Information"}),e.jsx(b,{sx:{mb:2}})]}),e.jsx(s,{item:!0,xs:12,children:e.jsx(n,{fullWidth:!0,label:"Street Address",name:"street_address",value:r.street_address,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"City",name:"city",value:r.city,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"State",name:"state",value:r.state,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"Postal Code",name:"postal_code",value:r.postal_code,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Country",name:"country",value:r.country,onChange:i,disabled:a})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(x,{variant:"h6",gutterBottom:!0,sx:{mt:2},children:"Preferences & Settings"}),e.jsx(b,{sx:{mb:2}})]}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Preferred Language",name:"preferred_language",value:r.preferred_language,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Timezone",name:"timezone",value:r.timezone,onChange:i,disabled:a})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(v,{control:e.jsx(w,{name:"is_active",checked:r.is_active,onChange:i,disabled:a}),label:"Active"})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(v,{control:e.jsx(w,{name:"newsletter_subscription",checked:r.newsletter_subscription,onChange:i,disabled:a}),label:"Newsletter Subscription"})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(v,{control:e.jsx(w,{name:"sms_notifications",checked:r.sms_notifications,onChange:i,disabled:a}),label:"SMS Notifications"})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(F,{sx:{display:"flex",gap:2,justifyContent:"flex-end",mt:3},children:[e.jsx(I,{variant:"outlined",onClick:D,disabled:a,children:"Cancel"}),e.jsx(I,{type:"submit",variant:"contained",disabled:a,startIcon:a?e.jsx(A,{size:20}):null,children:a?"Saving...":d?"Update":"Create"})]})})]})})]})};export{Y as default};
