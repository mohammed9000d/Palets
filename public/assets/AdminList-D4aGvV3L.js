import{a0 as E,r as a,j as e,M as g,B as S,a1 as k,a2 as B,T as f,a3 as y,I as D,a4 as w}from"./index-inj7p8C5.js";import{a as C}from"./api-pH0XAhJ5.js";import{A as P}from"./Alert-DNXzEesN.js";import{T as z,a as M,b as _,c,d as n,e as L,I as N,D as R,f as F,g as H,h as $}from"./TableRow-D4NGbAjX.js";import{I as q}from"./IconTrash-CxXHQrsT.js";import{B as d}from"./Button-MKQ-r-2B.js";const V=()=>{var p;const h=E(),[r,x]=a.useState([]),[A,j]=a.useState(!0),[m,t]=a.useState(""),[i,l]=a.useState({open:!1,admin:null});a.useEffect(()=>{b()},[]);const b=async()=>{try{j(!0);const s=await C.getAll();x(s.data),t("")}catch(s){t("Failed to fetch admins. Please check if the backend server is running."),console.error("Error fetching admins:",s)}finally{j(!1)}},I=async s=>{try{await C.delete(s.id),x(r.filter(o=>o.id!==s.id)),l({open:!1,admin:null})}catch(o){t("Failed to delete admin"),console.error("Error deleting admin:",o)}},T=s=>{h(`/admin/edit/${s.id}`,{state:{admin:s}})},v=s=>{l({open:!0,admin:s})},u=()=>{l({open:!1,admin:null})};return A?e.jsx(g,{title:"Admin Management",children:e.jsx(S,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(k,{})})}):e.jsxs(g,{title:"Admin Management",secondary:e.jsx(d,{variant:"contained",startIcon:e.jsx(w,{}),onClick:()=>h("/admin/create"),children:"Add Admin"}),children:[m&&e.jsx(P,{severity:"error",sx:{mb:2},children:m}),e.jsx(z,{component:B,children:e.jsxs(M,{children:[e.jsx(_,{children:e.jsxs(c,{children:[e.jsx(n,{children:"ID"}),e.jsx(n,{children:"Name"}),e.jsx(n,{children:"Email"}),e.jsx(n,{children:"Role"}),e.jsx(n,{children:"Status"}),e.jsx(n,{children:"Created At"}),e.jsx(n,{align:"center",children:"Actions"})]})}),e.jsx(L,{children:r.length===0?e.jsx(c,{children:e.jsx(n,{colSpan:7,align:"center",children:e.jsx(f,{variant:"body2",color:"textSecondary",children:"No admins found. Create your first admin!"})})}):r.map(s=>e.jsxs(c,{children:[e.jsx(n,{children:s.id}),e.jsx(n,{children:s.name}),e.jsx(n,{children:s.email}),e.jsx(n,{children:e.jsx(y,{label:s.role,color:s.role==="super_admin"?"primary":"default",size:"small"})}),e.jsx(n,{children:e.jsx(y,{label:s.is_active?"Active":"Inactive",color:s.is_active?"success":"error",size:"small"})}),e.jsx(n,{children:new Date(s.created_at).toLocaleDateString()}),e.jsxs(n,{align:"center",children:[e.jsx(D,{color:"primary",onClick:()=>T(s),size:"small",children:e.jsx(N,{})}),e.jsx(D,{color:"error",onClick:()=>v(s),size:"small",children:e.jsx(q,{})})]})]},s.id))})]})}),e.jsxs(R,{open:i.open,onClose:u,children:[e.jsx(F,{children:"Confirm Delete"}),e.jsx(H,{children:e.jsxs(f,{children:['Are you sure you want to delete admin "',(p=i.admin)==null?void 0:p.name,'"? This action cannot be undone.']})}),e.jsxs($,{children:[e.jsx(d,{onClick:u,children:"Cancel"}),e.jsx(d,{onClick:()=>I(i.admin),color:"error",variant:"contained",children:"Delete"})]})]})]})};export{V as default};
