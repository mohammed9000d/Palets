import{a0 as S,r as n,j as e,M as f,B as E,a1 as w,a2 as k,T as g,a3 as b,I as y,a4 as B}from"./index-DNfr9x4F.js";import{u as D}from"./api-BQFhURCH.js";import{A as N}from"./Alert-76NRBqFV.js";import{T as P,a as U,b as _,c,d as r,e as z,D as M,f as L,g as F,h as H}from"./TableRow-6aba_KU0.js";import{I as R}from"./IconEdit-CE5Qx0NF.js";import{I as $}from"./IconTrash-D5OUtA2T.js";import{B as d}from"./Button-CLm7eKfg.js";const W=()=>{var p;const h=S(),[t,x]=n.useState([]),[C,j]=n.useState(!0),[u,a]=n.useState(""),[l,i]=n.useState({open:!1,user:null});n.useEffect(()=>{I()},[]);const I=async()=>{try{j(!0);const s=await D.getAll();x(s.data),a("")}catch(s){a("Failed to fetch users. Please check if the backend server is running."),console.error("Error fetching users:",s)}finally{j(!1)}},T=async s=>{try{await D.delete(s.id),x(t.filter(o=>o.id!==s.id)),i({open:!1,user:null})}catch(o){a("Failed to delete user"),console.error("Error deleting user:",o)}},v=s=>{h(`/admin/users/edit/${s.id}`,{state:{user:s}})},A=s=>{i({open:!0,user:s})},m=()=>{i({open:!1,user:null})};return C?e.jsx(f,{title:"User Management",children:e.jsx(E,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"200px",children:e.jsx(w,{})})}):e.jsxs(f,{title:"User Management",secondary:e.jsx(d,{variant:"contained",startIcon:e.jsx(B,{}),onClick:()=>h("/admin/users/create"),children:"Add User"}),children:[u&&e.jsx(N,{severity:"error",sx:{mb:2},children:u}),e.jsx(P,{component:k,children:e.jsxs(U,{children:[e.jsx(_,{children:e.jsxs(c,{children:[e.jsx(r,{children:"ID"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Email"}),e.jsx(r,{children:"Phone"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Newsletter"}),e.jsx(r,{children:"Created At"}),e.jsx(r,{align:"center",children:"Actions"})]})}),e.jsx(z,{children:t.length===0?e.jsx(c,{children:e.jsx(r,{colSpan:8,align:"center",children:e.jsx(g,{variant:"body2",color:"textSecondary",children:"No users found. Create your first user!"})})}):t.map(s=>e.jsxs(c,{children:[e.jsx(r,{children:s.id}),e.jsx(r,{children:s.name}),e.jsx(r,{children:s.email}),e.jsx(r,{children:s.phone||"N/A"}),e.jsx(r,{children:e.jsx(b,{label:s.is_active?"Active":"Inactive",color:s.is_active?"success":"error",size:"small"})}),e.jsx(r,{children:e.jsx(b,{label:s.newsletter_subscription?"Subscribed":"Not Subscribed",color:s.newsletter_subscription?"primary":"default",size:"small"})}),e.jsx(r,{children:new Date(s.created_at).toLocaleDateString()}),e.jsxs(r,{align:"center",children:[e.jsx(y,{color:"primary",onClick:()=>v(s),size:"small",children:e.jsx(R,{})}),e.jsx(y,{color:"error",onClick:()=>A(s),size:"small",children:e.jsx($,{})})]})]},s.id))})]})}),e.jsxs(M,{open:l.open,onClose:m,children:[e.jsx(L,{children:"Confirm Delete"}),e.jsx(F,{children:e.jsxs(g,{children:['Are you sure you want to delete user "',(p=l.user)==null?void 0:p.name,'"? This action cannot be undone.']})}),e.jsxs(H,{children:[e.jsx(d,{onClick:m,children:"Cancel"}),e.jsx(d,{onClick:()=>T(l.user),color:"error",variant:"contained",children:"Delete"})]})]})]})};export{W as default};
