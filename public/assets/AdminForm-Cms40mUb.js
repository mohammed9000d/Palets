import{g as I,d as D,r as b,e as _,o as T,s as $,i as L,j as t,k as x,l as N,m as C,q as O,v as M,w as U,a8 as q,a9 as W,aa as V,ad as X,ae as G,M as H,B as P,F as J,ab as K}from"./index-opVpZ8nD.js";import{a as z}from"./api-D2le5508.js";import{A as R}from"./Alert-Dz9o8Ywu.js";import{T as A,S as Q}from"./TextField-B5fYsZVh.js";import{F as Y,I as Z}from"./InputLabel-ydp5cuoG.js";import{M as F}from"./MenuItem-Bf2IfiCw.js";import{B as E}from"./Button-C9WdRFLh.js";function ee(e){return D("MuiSwitch",e)}const i=I("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),ae=e=>{const{classes:a,edge:o,size:r,color:u,checked:v,disabled:n}=e,g={root:["root",o&&`edge${x(o)}`,`size${x(r)}`],switchBase:["switchBase",`color${x(u)}`,v&&"checked",n&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},w=N(g,ee,a);return{...a,...w}},te=$("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.root,o.edge&&a[`edge${x(o.edge)}`],a[`size${x(o.size)}`]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${i.thumb}`]:{width:16,height:16},[`& .${i.switchBase}`]:{padding:4,[`&.${i.checked}`]:{transform:"translateX(16px)"}}}}]}),se=$(O,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,a)=>{const{ownerState:o}=e;return[a.switchBase,{[`& .${i.input}`]:a.input},o.color!=="default"&&a[`color${x(o.color)}`]]}})(C(({theme:e})=>({position:"absolute",top:0,left:0,zIndex:1,color:e.vars?e.vars.palette.Switch.defaultColor:`${e.palette.mode==="light"?e.palette.common.white:e.palette.grey[300]}`,transition:e.transitions.create(["left","transform"],{duration:e.transitions.duration.shortest}),[`&.${i.checked}`]:{transform:"translateX(20px)"},[`&.${i.disabled}`]:{color:e.vars?e.vars.palette.Switch.defaultDisabledColor:`${e.palette.mode==="light"?e.palette.grey[100]:e.palette.grey[600]}`},[`&.${i.checked} + .${i.track}`]:{opacity:.5},[`&.${i.disabled} + .${i.track}`]:{opacity:e.vars?e.vars.opacity.switchTrackDisabled:`${e.palette.mode==="light"?.12:.2}`},[`& .${i.input}`]:{left:"-100%",width:"300%"}})),C(({theme:e})=>({"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette.action.activeChannel} / ${e.vars.palette.action.hoverOpacity})`:M(e.palette.action.active,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(e.palette).filter(U(["light"])).map(([a])=>({props:{color:a},style:{[`&.${i.checked}`]:{color:(e.vars||e).palette[a].main,"&:hover":{backgroundColor:e.vars?`rgba(${e.vars.palette[a].mainChannel} / ${e.vars.palette.action.hoverOpacity})`:M(e.palette[a].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${i.disabled}`]:{color:e.vars?e.vars.palette.Switch[`${a}DisabledColor`]:`${e.palette.mode==="light"?q(e.palette[a].main,.62):W(e.palette[a].main,.55)}`}},[`&.${i.checked} + .${i.track}`]:{backgroundColor:(e.vars||e).palette[a].main}}}))]}))),oe=$("span",{name:"MuiSwitch",slot:"Track"})(C(({theme:e})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:e.transitions.create(["opacity","background-color"],{duration:e.transitions.duration.shortest}),backgroundColor:e.vars?e.vars.palette.common.onBackground:`${e.palette.mode==="light"?e.palette.common.black:e.palette.common.white}`,opacity:e.vars?e.vars.opacity.switchTrack:`${e.palette.mode==="light"?.38:.3}`}))),ie=$("span",{name:"MuiSwitch",slot:"Thumb"})(C(({theme:e})=>({boxShadow:(e.vars||e).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),re=b.forwardRef(function(a,o){const r=_({props:a,name:"MuiSwitch"}),{className:u,color:v="primary",edge:n=!1,size:g="medium",sx:w,slots:m={},slotProps:c={},...S}=r,h={...r,color:v,edge:n,size:g},d=ae(h),y={slots:m,slotProps:c},[j,p]=T("root",{className:L(d.root,u),elementType:te,externalForwardedProps:y,ownerState:h,additionalProps:{sx:w}}),[s,f]=T("thumb",{className:d.thumb,elementType:ie,externalForwardedProps:y,ownerState:h}),l=t.jsx(s,{...f}),[k,B]=T("track",{className:d.track,elementType:oe,externalForwardedProps:y,ownerState:h});return t.jsxs(j,{...p,children:[t.jsx(se,{type:"checkbox",icon:l,checkedIcon:l,ref:o,ownerState:h,...S,classes:{...d,root:d.switchBase},slots:{...m.switchBase&&{root:m.switchBase},...m.input&&{input:m.input}},slotProps:{...c.switchBase&&{root:typeof c.switchBase=="function"?c.switchBase(h):c.switchBase},...c.input&&{input:typeof c.input=="function"?c.input(h):c.input}}}),t.jsx(k,{...B})]})}),he=()=>{const e=V(),{id:a}=X(),o=G(),r=!!a,[u,v]=b.useState({name:"",email:"",password:"",role:"admin",is_active:!0}),[n,g]=b.useState(!1),[w,m]=b.useState(""),[c,S]=b.useState("");b.useEffect(()=>{var p;if(r)if((p=o.state)!=null&&p.admin){const s=o.state.admin;v({name:s.name,email:s.email,password:"",role:s.role,is_active:s.is_active})}else h()},[a,r,o.state]);const h=async()=>{try{g(!0);const s=(await z.getById(a)).data;v({name:s.name,email:s.email,password:"",role:s.role,is_active:s.is_active})}catch(p){m("Failed to fetch admin details"),console.error("Error fetching admin:",p)}finally{g(!1)}},d=p=>{const{name:s,value:f,checked:l}=p.target;v(k=>({...k,[s]:s==="is_active"?l:f}))},y=async p=>{var s,f;p.preventDefault(),g(!0),m(""),S("");try{const l={...u};r&&!l.password&&delete l.password,r?(await z.update(a,l),S("Admin updated successfully!")):(await z.create(l),S("Admin created successfully!")),setTimeout(()=>{e("/admin/list")},2e3)}catch(l){if((f=(s=l.response)==null?void 0:s.data)!=null&&f.errors){const k=l.response.data.errors,B=Object.values(k).flat().join(", ");m(B)}else m("Failed to save admin. Please try again.");console.error("Error saving admin:",l)}finally{g(!1)}},j=()=>{e("/admin/list")};return t.jsxs(H,{title:r?"Edit Admin":"Create Admin",children:[w&&t.jsx(R,{severity:"error",sx:{mb:2},children:w}),c&&t.jsx(R,{severity:"success",sx:{mb:2},children:c}),t.jsx(P,{component:"form",onSubmit:y,noValidate:!0,children:t.jsxs(P,{sx:{display:"flex",flexDirection:"column",gap:3},children:[t.jsx(A,{fullWidth:!0,label:"Name",name:"name",value:u.name,onChange:d,required:!0,disabled:n}),t.jsx(A,{fullWidth:!0,label:"Email",name:"email",type:"email",value:u.email,onChange:d,required:!0,disabled:n}),t.jsx(A,{fullWidth:!0,label:"Password",name:"password",type:"password",value:u.password,onChange:d,required:!r,helperText:r?"Leave empty to keep current password":"",disabled:n}),t.jsxs(Y,{fullWidth:!0,children:[t.jsx(Z,{children:"Role"}),t.jsxs(Q,{name:"role",value:u.role,onChange:d,label:"Role",disabled:n,children:[t.jsx(F,{value:"admin",children:"Admin"}),t.jsx(F,{value:"super_admin",children:"Super Admin"})]})]}),t.jsx(J,{control:t.jsx(re,{name:"is_active",checked:u.is_active,onChange:d,disabled:n}),label:"Active"}),t.jsxs(P,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[t.jsx(E,{variant:"outlined",onClick:j,disabled:n,children:"Cancel"}),t.jsx(E,{type:"submit",variant:"contained",disabled:n,startIcon:n?t.jsx(K,{size:20}):null,children:n?"Saving...":r?"Update":"Create"})]})]})})]})};export{he as default};
