import{ad as B,ag as D,ah as L,r as o,j as e,M,B as v,g as j,F as P,I as k,ai as W,c as q,aj as R,d as w,ae as T}from"./index-CNxw_XuV.js";import{a as g,A}from"./api-OBfDdljk.js";import{M as S}from"./MenuItem-Lslsmps6.js";const U=()=>{const b=B(),{id:d}=D(),p=L(),i=!!d,[n,h]=o.useState({name:"",email:"",password:"",role:"admin",is_active:!0}),[t,c]=o.useState(!1),[y,m]=o.useState(""),[C,f]=o.useState("");o.useEffect(()=>{var r;if(i)if((r=p.state)!=null&&r.admin){const a=p.state.admin;h({name:a.name,email:a.email,password:"",role:a.role,is_active:a.is_active})}else E()},[d,i,p.state]);const E=async()=>{try{c(!0);const a=(await g.getById(d)).data;h({name:a.name,email:a.email,password:"",role:a.role,is_active:a.is_active})}catch(r){m("Failed to fetch admin details"),console.error("Error fetching admin:",r)}finally{c(!1)}},l=r=>{const{name:a,value:u,checked:s}=r.target;h(x=>({...x,[a]:a==="is_active"?s:u}))},_=async r=>{var a,u;r.preventDefault(),c(!0),m(""),f("");try{const s={...n};i&&!s.password&&delete s.password,i?(await g.update(d,s),f("Admin updated successfully!")):(await g.create(s),f("Admin created successfully!")),setTimeout(()=>{b("/admin/list")},2e3)}catch(s){if((u=(a=s.response)==null?void 0:a.data)!=null&&u.errors){const x=s.response.data.errors,I=Object.values(x).flat().join(", ");m(I)}else m("Failed to save admin. Please try again.");console.error("Error saving admin:",s)}finally{c(!1)}},F=()=>{b("/admin/list")};return e.jsxs(M,{title:i?"Edit Admin":"Create Admin",children:[y&&e.jsx(A,{severity:"error",sx:{mb:2},children:y}),C&&e.jsx(A,{severity:"success",sx:{mb:2},children:C}),e.jsx(v,{component:"form",onSubmit:_,noValidate:!0,children:e.jsxs(v,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsx(j,{fullWidth:!0,label:"Name",name:"name",value:n.name,onChange:l,required:!0,disabled:t}),e.jsx(j,{fullWidth:!0,label:"Email",name:"email",type:"email",value:n.email,onChange:l,required:!0,disabled:t}),e.jsx(j,{fullWidth:!0,label:"Password",name:"password",type:"password",value:n.password,onChange:l,required:!i,helperText:i?"Leave empty to keep current password":"",disabled:t}),e.jsxs(P,{fullWidth:!0,children:[e.jsx(k,{children:"Role"}),e.jsxs(W,{name:"role",value:n.role,onChange:l,label:"Role",disabled:t,children:[e.jsx(S,{value:"admin",children:"Admin"}),e.jsx(S,{value:"super_admin",children:"Super Admin"})]})]}),e.jsx(q,{control:e.jsx(R,{name:"is_active",checked:n.is_active,onChange:l,disabled:t}),label:"Active"}),e.jsxs(v,{sx:{display:"flex",gap:2,justifyContent:"flex-end"},children:[e.jsx(w,{variant:"outlined",onClick:F,disabled:t,children:"Cancel"}),e.jsx(w,{type:"submit",variant:"contained",disabled:t,startIcon:t?e.jsx(T,{size:20}):null,children:t?"Saving...":i?"Update":"Create"})]})]})})]})};export{U as default};
